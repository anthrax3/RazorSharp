@{
    Layout = "~/Admin/_Layout.cshtml";
    Page.Title = "Contact Form - Install";
    Page.Heading = "Installing...";
    var message = string.Empty;

    IEnumerable<dynamic> data;
    using (var db = Database.Open(Functions.GetDbName()))
    {
        const string sqlSelect = "Select * From Widgets Where wName = 'contact-form'";
        data = db.Query(sqlSelect);
    }

    if (!data.Any()){
        //insert widget
        const string wName = "contact-form";
        const string wFile = "addon_ContactForm.cshtml";
        const string wTitle = "Contact Form - Do Not Modify";
        const string wText = "To change this widget please go to Addons";
        var wEditDate = DateTime.Now;

        using (var db = Database.Open(Functions.GetDbName()))
        {
            const string sqlInsert = "Insert into Widgets (wName, wTitle, wText, wEditDate, wFile) values (@0, @1, @2, @3, @4)";
            db.Execute(sqlInsert, wName, wTitle, wText, wEditDate, wFile);
        }
        if (Request.UrlReferrer != null)
        {
            Response.Redirect(Request.UrlReferrer.ToString());
        }
    }
    else
    {
        message = Helpers.alertWarning("The Addon Install Has Already Been Done!");
    }

}
@section Scripts {

}
@section Menu{
    @RenderPage("~/Admin/_Menu.cshtml")
}
@Html.Raw(message)